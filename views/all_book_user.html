<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>All Books - Gatherbooks</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />
    <style>
      .no-scrollbar::-webkit-scrollbar { display: none; }
      .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

      @supports not ((-webkit-backdrop-filter: none) or (backdrop-filter: none)) {
        .backdrop-blur-lg { background-color: rgba(255, 255, 255, 0.85); }
      }

      .book-card { height: 280px; } 

      .blur-section { height: 900px; }
    </style>
  </head>
  <body class="min-h-screen flex flex-col bg-[url('/img/background.svg')] bg-no-repeat bg-center bg-cover font-sans">

    <nav class="sticky top-0 z-50 bg-white/80 backdrop-blur-lg shadow-md">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-20">
          <div class="flex-shrink-0">
            <img src="/img/getherbooks.png" alt="Gatherbooks" class="h-12" />
          </div>
          <div class="flex items-center gap-6">
            <div class="hidden md:flex items-center gap-2 bg-gray-100 p-1 rounded-xl">
              <a href="/home" class="font-semibold text-gray-500 hover:bg-white hover:text-blue-600 px-4 py-2 rounded-lg transition">Home</a>
              <a href="/bookings_in_user" class="font-semibold text-gray-500 hover:bg-white hover:text-blue-600 px-4 py-2 rounded-lg transition">Bookings</a>
            </div>
            <div class="flex md:hidden items-center gap-5">
              <a href="/home" class="text-2xl text-gray-600 hover:text-blue-600"><i class="bi bi-house-door-fill"></i></a>
              <a href="/bookings_in_user" class="text-2xl text-gray-600 hover:text-blue-600"><i class="bi bi-journal-check"></i></a>
            </div>
            <div class="flex items-center gap-6">
              <a href="/settings_user" class="text-2xl text-gray-600 hover:text-blue-600"><i class="bi bi-gear-fill"></i></a>
              <form action="/logout" method="POST">
                <button type="submit" class="hidden md:flex bg-red-500 text-white font-semibold px-4 py-2 rounded-lg hover:bg-red-600 transition">Logout</button>
                <button type="submit" class="md:hidden text-2xl text-red-500 hover:text-red-600"><i class="bi bi-box-arrow-right"></i></button>
              </form>
            </div>
          </div>
        </div>
      </div>
    </nav>

    <main class="flex-1 max-w-6xl mx-auto w-full px-4 sm:px-6 lg:px-8 py-12 flex flex-col">

      <section class="blur-section bg-white/30 backdrop-blur-lg rounded-3xl shadow-2xl p-6 md:p-10 flex flex-col">

        <div class="flex justify-between">
          {{if .Books}}
            <h2 class="text-3xl font-bold text-gray-800">{{(index .Books 0).CategoryName}}</h2>
          {{else}}
            <h2 class="text-3xl font-bold text-gray-800">All Books</h2>
          {{end}}

          <a href="/home#category-{{.CategoryID}}" class="font-semibold flex items-center gap-1 bg-red-600 p-3 rounded-xl">
             <i class="bi bi-arrow-left"></i>
             <span>Back to List</span>
          </a>
        </div>

        <hr class="border-gray-300 my-6">

        <div class="flex flex-wrap justify-start gap-6 flex-1 no-scrollbar">
          {{range .Books}}
            <div class="book-card bg-white rounded-2xl w-56 ml-2 shadow overflow-hidden group transition-all duration-300 hover:shadow-xl hover:scale-105 flex flex-col">
              <div class="relative h-40 w-full">
                <img src="{{.Img}}" alt="{{.Title}}" class="h-full w-full object-cover rounded-t-2xl"/>
                <span class="absolute top-2 right-2 px-3 py-1 text-xs font-bold text-white rounded-full shadow-lg {{if .IsBorrowed}} bg-red-500 {{else}} bg-green-500 {{end}}" title="{{if .IsBorrowed}}Checked Out{{else}}Available{{end}}">
                  <i class="{{if .IsBorrowed}}bi bi-x-circle-fill{{else}}bi bi-check-circle-fill{{end}}"></i>
                  {{if .IsBorrowed}} Borrowed {{else}} Available {{end}}
                </span>
              </div>
              <div class="p-3 flex flex-col justify-between flex-1">
                <h4 class="font-extrabold text-gray-900 text-lg truncate">{{.Title}}</h4>
                <a href="/view_detail_user/{{.ID}}?category={{$.CategoryID}}&search={{$.Search}}" class="w-full text-sm py-2 mt-3 rounded-xl bg-blue-600 text-white text-center hover:bg-blue-700 transition block font-bold shadow-lg">View Details</a>
              </div>
            </div>
          {{end}}
        </div>

        <hr class="border-gray-300 my-6">

        <div class="mt-6">
          <nav class="flex flex-wrap gap-2 justify-center">
            {{range .Pages}}
              <a class="px-3 py-1 rounded-lg font-semibold transition {{if eq $.Page .}}bg-blue-600 text-white{{else}}bg-gray-200 hover:bg-gray-300{{end}}" 
                 href="/all?page={{.}}&search={{$.Search}}&category={{$.CategoryID}}">
                {{.}}
              </a>
            {{end}}
          </nav>
        </div>

      </section>
    </main>

    <footer class="w-full bg-white/80 backdrop-blur-lg shadow-inner text-center text-gray-600 py-6 mt-auto">
      Â© 2025 Gatherbooks. All rights reserved.
    </footer>

  </body>
</html>